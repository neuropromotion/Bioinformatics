```{r}
sample_id = 1
main_path <- '/mnt/jack-5/amismailov/miRNA_study/thyroid/'  

```
 
# DATA LOAD
```{r}
library(Matrix)
library(Seurat)
library(data.table)

path <- paste0(main_path, sample_id)

# counts
counts <- readMM(file.path(path, "matrix.mtx.gz"))

# barcodes
barcodes <- fread(file.path(path, "barcodes.tsv.gz"), header = FALSE)[[1]]

# features
features <- fread(file.path(path, "features.tsv.gz"), header = FALSE)
colnames(features) <- c("feature_id", "feature_name")


rownames(counts) <- features$feature_id
colnames(counts) <- barcodes

seu <- CreateSeuratObject(
  counts = counts,
  project = as.character(sample_id)
)
seu[["RNA"]]@meta.data$gene_id <- features$feature_id
seu[["RNA"]]@meta.data$gene_name <- features$feature_name # save HGNC: BEST practice
print(seu)
```


```{r}
features
```

```{r}
rownames(seu)[1:10]
```
